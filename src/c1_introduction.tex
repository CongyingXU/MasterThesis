\chapter{绪论}

% 本章节概述了背景、研究目的与意义\cite{jia2021:oss-vulnerability, mitre2021:cve}。
本章将详细阐述本文的研究背景、主要工作以及本文的篇章结构。

\section{研究背景及问题}

开源软件（Open Source Software，OSS）为开源及闭源应用程序的开发提供了基础，应用程序的开发人员可以直接使用开源软件提供的通用功能而不需重新造轮子。据Synopsys公司发布的《开源安全和风险分析报告》\cite{Synopsys-report}中数据显示，分析的1,500个应用程序中有98\%的应用程序都包含开源软件。然而，大规模使用开源软件加速了应用程序开发的进程，但同时引入了安全风险。例如，Synopsys公司在2020年分析的1,500个应用程序中有84\%的应用程序包含至少一个公共OSS漏洞，对比2019年时的数据（75\%）增加了9\%\cite{Synopsys-report}。更糟糕的是，据Snyk公司发布的报告\cite{Snyk-report}显示：近些年开源软件中披露的漏洞越来越多，在过去两年中几乎翻了一倍。

为此，大量工作都在研究如何降低开源软件漏洞的安全风险，其中包括：通过学习漏洞特征来检测开源软件中的漏洞\cite{li2016vulpecker,li2018vuldeepecker,zhou2019devign,jimenez2019importance}，通过匹配漏洞及补丁签名\cite{jang2012redebug，kim2017vuddy，xu2020patch，xiao2020mvp，cui2020vuldetector}以修复开源软件中的漏洞\cite{mulliner2013patchdroid，duan2019automating，xu2020automatic，machiry2020spider}，或分析软件组成成分以确定应用程序中的开源漏洞是否可达\cite{pashchenko2018vulnerable,ponta2020detection,pashchenko2020vuln4real,Wang2020empirical}。

值得注意的是，漏洞数据库在这些工作中发挥着重要作用，体现在为各种漏洞分析任务提供有价值的数据（例如，漏洞描述、受漏洞影响的软件、版本以及补丁信息）。目前，已有多方力量致力于构建漏洞数据库。在安全社区中，CVE List\cite{cve}和NVD\cite{nvd}是最具影响力的漏洞数据库，该数据库包含应用软件、系统以及硬件的漏洞。在工业界中，BlackDuck\cite{blackduck}、WhiteSource\cite{whitesource}、Veracode\cite{veracode}和Snyk\cite{snyk}等公司较为关注开源软件的漏洞，并构建各自的工业数据库。在学术界中，已有很多工作致力于构建漏洞数据集\cite{ponta2019manually,fan2020ac,jimenez2018enabling,gkortzis2018vulinoss,namrud2019androvul}，但它们大多针对特定语言的生态系统或针对特定的软件项目而设计的。

\textbf{研究问题：}随着这些漏洞数据库积累越来越多的漏洞，人们也越来越关注这些数据库中漏洞信息的质量。Nguyen、Massacci\cite{nguyen2013reliability}和Dong等人\cite{dong2019towards}发现了漏洞数据库中受漏洞影响的软件版本信息的不准确性
Chaparro等人\cite{chaparro2017detecting}和Mu等人\cite{mu2018understanding}发现了漏洞描述中缺失关键漏洞重现步骤的普遍性。这种不完整或不准确的信息使得安全工作人员难以及时地识别、重现和修复应用程序中及其使用的开源软件中的漏洞。

漏洞补丁，作为捕获漏洞的宝贵信息，可应用于多种程序安全相关的任务，例如，补丁生成和热部署\cite{mulliner2013patchdroid,duan2019automating,xu2020automatic}、补丁存在测试\cite{zhang2018precise,jiang2020pdiff,dai2020bscout}、软件成分分析\cite{ponta2020detection,pashchenko2020vuln4real,Wang2020empirical}以及漏洞检测\cite{li2016vulpecker,li2018vuldeepecker,jang2012redebug,kim2017vuddy, xiao2020mvp, cui2020vuldetector}。如果漏洞的补丁信息缺失或不准确，那么这些安全应用的准确性将会受到严重的影响。然而，漏洞数据库中补丁信息尚未被系统地研究，目前尚不清楚现有漏洞数据库中补丁的质量如何。

此外，现有的安全应用主要通过人工手动定位漏洞补丁\cite{xu2020automatic,jiang2020pdiff,dai2020bscout,zhou2017automated,sabetta2018practical,chen2020machine,xiao2020mvp,ponta2020detection,pashchenko2020vuln4real}，或是通过启发式规则，在CVE引用信息中查找代码提交\cite{duan2019automating,li2016vulpecker,li2018vuldeeepecker}以及并在代码提交历史中搜索CVE标识符（CVE-ID）\cite{you2017semfuzz,Wang2020empirical}，或者从已经为特定项目建立漏洞和补丁之间映射关系的安全公告中搜索漏洞补丁\cite{mulliner2013patchdroid,jang2012redebug,kim2017vuddy}。以上这些方法的人工成本过高，且过于定制化具体的程序语言或项目无法广泛应用于所有开源软件漏洞。

\section{本文工作概述}
为了解决以上研究问题，本文先进行了一项经验研究，以了解当前顶级工业漏洞数据库中开源软件漏洞补丁的质量和特征。该研究涵盖主要五个方面，包括：补丁的覆盖度、一致性、类型、映射关系和准确性。然后，受经验研究结果的启发，本文提出了第一种名为\tool 的基于多源信息的开源软件漏洞的补丁识别方法。本文还设计了大量实验验证了\tool 的准确性、通用性、实用性等方面。\tool 的源代码和所有实验数据已经在\url{https://patch-tracer.github.io}网站上发布。

\subsection{经验研究}
为了解当前顶级工业漏洞数据库中开源软件漏洞补丁的质量和特征，涵盖：补丁的覆盖度、一致性、类型、映射关系和准确性五个方面。该经验研究选择Veracode\cite{veracode}公司和Snyk\cite{snyk}公司公开的漏洞数据库作为研究对象。

基于经验研究中构建的包含10，070个漏洞的广度数据集，本文分析两个漏洞数据库中所有开源软件漏洞补丁信息的覆盖率和一致性。结果表明，\tocheck{10,070}个CVE漏洞中只有\tocheck{4,602(5.7\%)}的漏洞至少由一个漏洞数据库提供补丁信息，只有\tocheck{19.7\%}的漏洞在两个数据库中有一致的补丁信息。\congyingEdit{可以再写些其他的结果}。

此外，基于经验研究中构建的包含\tocheck{1,295}个漏洞的深度数据集，本文分析了开源软件漏洞补丁类型、映射关系和准确性。结果表明，\tocheck{1,295}个CVE漏洞中，\tocheck{1,265(97.7\%)}的漏洞有GitHub和SVN Commit提交类型的补丁，\tocheck{533(41.1\%)}的CVE漏洞与其补丁在数量上有一对多的映射关系。这两个数据库的总体补丁精度都高于\tocheck{90\%}，然而，对于一对多映射类型的CVE漏洞，这两个数据库中补丁的召回率仅约为\tocheck{50\%}。

这些结果表明，这两个顶级工业漏洞数据库经常会遗漏一些漏洞的补丁信息，尤其是对于有多个补丁的CVE漏洞，补丁缺失现象更为严重。这种不完整或不准确的信息使得安全工作人员难以及时地识别、重现和修复应用程序中及其使用的开源软件中的漏洞。同时，这也反映出自动化补丁查找方法的需求，以帮助工作人员正确且完全地找到补丁信息。

\subsection{方法设计}
受经验研究结果的启发，本文提出了第一种名为\tool 的基于多源信息的开源软件漏洞的补丁识别方法，从多个知识源（即：NVD\cite{nvd}，Debian\cite{debian}，Red Hat\cite{redhat}以及GitHub）。该方法的核心思想是：漏洞的补丁信息（即：Commit URL）会在与该漏洞相关的各种来源的漏洞公告、分析报告、讨论和解决的过程中被频繁提及和引用；因此，本文首先设计了一种基于多知识源的漏洞引用信息网络，再从该网络中选出具有最高置信度和连通度的补丁节点作为结果。

\tool 以漏洞的CVE-ID作为输入，主要经过三个步骤：首先，构建多源信息网络，该步骤的目的是将该CVE在被报告、讨论和解决阶段的引用链接信息进行建模。\tool 从多个\tocheck{漏洞知识源}（即：NVD、Debian\cite{debian}、RedHat\cite{redhat}和GitHub）中提取与该CVE相关的引用链接信息并构建一个信息网络。然后，精选补丁节点，\tool 从构建的引用信息网络中选择中具有高连通性和高置信度的补丁节点作为该CVE的补丁。最后，扩增候选补丁，\tool 通过搜索同一代码库所有分支中的相关提交（Commit）来扩展候选补丁集。最终，\tool 将该CVE的候选补丁集返回给用户，用户可基于\tool 提供的信息选定确认正确的补丁。

\subsection{实验验证}
为了评估\tool 的准确性，本文将\tool 与三种基于启发式的方法和两个顶级工业漏洞数据库在经验研究中构建地深度数据集上进行了对比。结果表明，（1）与现有的基于启发式的方法相比，\tool 将能找到补丁的漏洞数提高\tocheck{58.6\%}到\tocheck{273.8\%}，同时，将F1值提高\tocheck{116.8\%}。（2）\tool 具有比$DB_A$和$DB_B$高\tocheck{15.5\%和18.4\%}的召回率和\tocheck{5.5\%到8.6\%}的F1值，同时牺牲了\tocheck{6.4\%}的精度和\tocheck{12.0\%}CVE的补丁信息。

此外，为了评估\tool 的通用性，本文还在另外两个分别包含\tocheck{3,185}和\tocheck{5,468}个CVE的数据集上运行\tool 。结果表明，\tool 在两个附加数据集上可查找到\tocheck{67.7\%}和\tocheck{51.5\%}CVE的补丁，通过采样评估，精度分别为\tocheck{0.823}和\tocheck{0.888}，召回率分别为\tocheck{0.845}和\tocheck{0.899}，体现出\tool 在查找补丁方面具有较好的通用性。

此外，为了评估\tool 的实用性，本文还邀请了10名参与者进行了用户研究。评估结果表明，在实际使用中，\tool 有助于安全专家更准确、更快速地查找到补丁信息。

\subsection{主要贡献}
本文主要有以下贡献。
\begin{itemize}[leftmargin=*]
\item 本文进行了一项经验研究，以了解当前顶级工业漏洞数据库中开源软件漏洞补丁的质量和特征。该研究涵盖主要五个方面，包括：补丁的覆盖度、一致性、类型、映射关系和准确性。
\item 本文提出了第一种名为 \tool 的基于多源信息的开源软件漏洞的补丁识别方法，可服务于安全社区、工业界和学术界。
\item 本文进行了一系列实验验证，以评估\tool 的准确性、通用性、在实践中的实用性等方面。
\end{itemize}


\section{本文篇章结构}
本论文一共六章，结构如下：

第一章绪论，介绍了本文的研究背景及研究问题，然后概述了本文的主要工作及主要贡献，包括：经验研究、方法设计和实验验证，以及本文的篇章结构。

第二章背景知识及相关工作，介绍了本文所涉及的背景知识，包括：通用漏洞披露（CVE）、漏洞公告、漏洞补丁等信息，为后文经验研究、方法设计等内容的详细阐述做铺垫；本章还介绍了本文研究主题的相关工作，包括：漏洞信息质量、漏洞补丁分析以及漏洞补丁的应用。

第三章经验研究，介绍了本文为了解当前顶级工业漏洞数据库中开源软件漏洞补丁的质量和特征所开展的实证研究工作，涵盖：补丁的覆盖度、一致性、类型、映射关系和准确性五个方面。

第四章\tool 方法设计，介绍了本文提出了第一种名为\tool 的基于多源信息的开源软件漏洞的补丁识别方法，包括：多源信息网络构建、补丁节点精选以及候选补丁扩增三个步骤。

第五章实验验证及结果分析，介绍了本文评估\tool 的准确性、通用性、在实践中的实用性等方面的实验设计及结果分析。 

第六章总结与展望，对本文的工作内容及研究成果进行总结，讨论本文研究工作中存在的不足及可以改进的地方，并展望了未来可以进行的工作。
